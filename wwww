import pandas as pd
import os

# TÃªn file báº¡n nghi ngá» cÃ³ 7k phishing
FILE_PATH = 'old_phishing_7k.csv' 

def check_file():
    if not os.path.exists(FILE_PATH):
        print(f"âŒ KhÃ´ng tÃ¬m tháº¥y file: {FILE_PATH}")
        return

    print(f"ğŸ” Äang kiá»ƒm tra file: {FILE_PATH}")
    print("-" * 50)

    try:
        # Äá»c file
        df = pd.read_csv(FILE_PATH)
        
        # 1. Hiá»ƒn thá»‹ 5 dÃ²ng Ä‘áº§u tiÃªn Ä‘á»ƒ xem tÃªn cá»™t
        print("ğŸ“‹ 5 dÃ²ng Ä‘áº§u tiÃªn cá»§a dá»¯ liá»‡u:")
        print(df.head())
        print("-" * 50)

        # 2. Thá»‘ng kÃª tá»•ng sá»‘ dÃ²ng
        total_rows = len(df)
        print(f"ğŸ“Š Tá»•ng sá»‘ dÃ²ng thá»±c táº¿: {total_rows:,}")

        # 3. Thá»‘ng kÃª theo nhÃ£n (Label)
        if 'label' in df.columns:
            print("\nğŸ“ˆ Thá»‘ng kÃª theo nhÃ£n (Label):")
            # Chuáº©n hÃ³a nhÃ£n vá» chá»¯ thÆ°á»ng Ä‘á»ƒ Ä‘áº¿m chÃ­nh xÃ¡c
            df['label_check'] = df['label'].astype(str).str.lower()
            counts = df['label_check'].value_counts()
            for label, count in counts.items():
                print(f"   - NhÃ£n '{label}': {count:,} dÃ²ng")
        else:
            print("\nâš ï¸ KhÃ´ng tÃ¬m tháº¥y cá»™t 'label'. CÃ¡c cá»™t hiá»‡n cÃ³ lÃ :")
            print(df.columns.tolist())

        # 4. Kiá»ƒm tra URL trÃ¹ng láº·p
        if 'url' in df.columns:
            duplicates = df.duplicated(subset=['url']).sum()
            print(f"\nğŸ”— Sá»‘ lÆ°á»£ng URL trÃ¹ng láº·p: {duplicates:,}")
            print(f"âœ¨ Sá»‘ lÆ°á»£ng URL duy nháº¥t: {total_rows - duplicates:,}")

    except Exception as e:
        print(f"âŒ Lá»—i khi Ä‘á»c file: {e}")

if __name__ == "__main__":
    check_file()
